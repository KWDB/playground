services:
  playground:
    build:
      context: ../..
      dockerfile: docker/playground/Dockerfile
    image: kwdb/playground:latest
    container_name: kwdb-playground
    ports:
      - "${SERVER_PORT:-3006}:3006"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - GIN_MODE=release
      - SERVER_PORT=3006
      - COURSES_USE_EMBED=true
      - DOCKER_DEPLOY=true
      - LOG_LEVEL=${LOG_LEVEL:-info}
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:3006/health"]
      interval: 30s
      timeout: 5s
      start_period: 10s
      retries: 3
